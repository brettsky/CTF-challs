The CSRF token is a system used to prevent Cross-Site Request Forgery attacks . The attack consists of tricking a user of a web service into clicking on a link or submit button in an email or on a website controlled by the attacker, targeting a "malicious" resource on the target service (e.g., a resource whose request represents an account deletion command). The session cookie mechanism, which can only be obtained with a username and password unknown to the attacker, prevents the attacker from personally performing the "malicious" operation by impersonating the user. However, if the user is tricked into clicking the malicious link on a machine from which they have previously logged in to the target service, the cookie containing the session token will be automatically attached to the request, validating it, without the attacker needing to steal it or reproduce a counterfeit one.

The CSRF token prevents this type of attack because it isn't automatically sent by the browser like regular cookies. It is still stored on the client machine in a storage accessible only to the resources associated with the relevant service (and therefore outside the attacker's control), but it must be explicitly attached to HTTP requests, for example, as a GET parameter or within the body of a POST request, when they are executed. This makes it impossible to trick the user into generating a malicious request with a simple click, because to generate a malicious link, the attacker would need to know the token. To further complicate matters, CSRF tokens are typically disposable, and for each successful operation, the client receives a new, randomly generated token. The new token is typically appended to the body of the returned resource.

In this challenge, the flag is divided into four pieces, accessible via the resource http://web-11.challs.olicyber.it/flag_piecebased on the parameter index. To access them, you must have previously sent a POST login request to the resource http://web-11.challs.olicyber.it/login, with a JSON body containing "username": "admin"e "password": "admin", and received a session cookie in return. In addition to the session token in the cookie, the resource loginwill also return a CSRF token in the response body (also JSON). For each successful request, the client will receive a new token to use for the next one.

It is recommended to use an object Sessionto handle the session cookie, and the jsonresponse object method to decode its body automatically.